{{/* Tag-based filtering for city guides */}}
<div class="tag-filters">
  <h3>Filter by Category</h3>
  <div class="filter-buttons">
    <button class="filter-btn active" data-filter="all">All Cities</button>
    <button class="filter-btn" data-filter="budget-friendly">💰 Budget-Friendly</button>
    <button class="filter-btn" data-filter="family-friendly">👨‍👩‍👧‍👦 Family-Friendly</button>
    <button class="filter-btn" data-filter="weekend">🌟 Weekend Getaway</button>
    <button class="filter-btn" data-filter="culture">🎨 Culture & Arts</button>
    <button class="filter-btn" data-filter="outdoor">🏞️ Outdoor Activities</button>
    <button class="filter-btn" data-filter="food">🍽️ Food Scene</button>
  </div>
</div>

<div class="filtered-content">
  {{- range .Pages -}}
  <div class="city-card" 
       data-tags="{{ delimit .Params.categories "," }}{{ if .Params.budget_friendly }},budget-friendly{{ end }}{{ if .Params.family_friendly }},family-friendly{{ end }}{{ if .Params.weekend }},weekend{{ end }}{{ if .Params.culture }},culture{{ end }}{{ if .Params.outdoor }},outdoor{{ end }}{{ if .Params.food }},food{{ end }}">
    
    <div class="card-header">
      {{- if .Params.cover.image -}}
      <div class="card-image">
        {{- partial "image-optimization.html" (dict "src" (printf "%s%s" .Permalink .Params.cover.image) "alt" .Params.cover.alt "class" "card-img" "loading" "lazy") -}}
      </div>
      {{- end -}}
      
      <div class="card-content">
        <h3 class="card-title">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
        </h3>
        
        <div class="card-meta">
          <span class="publish-date">{{ .Date.Format "Jan 2, 2006" }}</span>
          {{- partial "reading-time.html" . -}}
        </div>
        
        <p class="card-summary">{{ .Summary }}</p>
        
        <div class="card-tags">
          {{- range .Params.tags -}}
          <span class="tag">{{ . }}</span>
          {{- end -}}
        </div>
      </div>
    </div>
  </div>
  {{- end -}}
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const filterButtons = document.querySelectorAll('.filter-btn');
  const cityCards = document.querySelectorAll('.city-card');
  
  filterButtons.forEach(button => {
    button.addEventListener('click', function() {
      const filter = this.dataset.filter;
      
      // Update active button
      filterButtons.forEach(btn => btn.classList.remove('active'));
      this.classList.add('active');
      
      // Filter cards
      cityCards.forEach(card => {
        const cardTags = card.dataset.tags.split(',');
        
        if (filter === 'all' || cardTags.includes(filter)) {
          card.style.display = 'block';
          card.style.animation = 'fadeIn 0.3s ease';
        } else {
          card.style.display = 'none';
        }
      });
    });
  });
});
</script>
